2025-03-04 21:56:32,068 - INFO - FTSET: .ver02
2025-03-04 21:56:32,068 - INFO - Full Retrain: True
2025-03-04 21:56:32,068 - INFO - Model Module: models.guess
2025-03-04 21:56:32,107 - INFO - Imported Model from module models.guess
2025-03-04 21:56:32,107 - INFO - Loading training data from task/train_set/x_train.ver02.parquet and task/train_set/y_train.ver02.parquet
2025-03-04 21:56:34,067 - INFO - Training data: 1674104 samples, 96 features
2025-03-04 21:56:34,100 - INFO - Model hyperparameters: {'constant': None, 'random_state': 42, 'strategy': 'stratified'}
2025-03-04 21:56:34,100 - INFO - Training model...
2025-03-04 21:56:35,863 - INFO - Model training completed. Took: 0:00:01.762654
2025-03-04 21:56:35,863 - INFO - Model saved to logs/2025.03.04_21:56:32_models.guess_full_retrain_model.pkl
2025-03-04 21:56:35,863 - INFO - Loading validation data from task/val_set/x_val.ver02.parquet and task/val_set/y_val.ver02.parquet
2025-03-04 21:56:38,504 - INFO - Validation data: 1792506 samples, 96 features
2025-03-04 21:56:38,540 - INFO - Predicting on validation set...
2025-03-04 21:56:40,620 - INFO - Classification Report on Validation Set:
              precision    recall  f1-score   support

           0       0.87      0.87      0.87   1565633
           1       0.13      0.13      0.13    226873

    accuracy                           0.78   1792506
   macro avg       0.50      0.50      0.50   1792506
weighted avg       0.78      0.78      0.78   1792506

2025-03-04 21:56:40,621 - INFO - Classification Report **Per Account** on Validation Set:
predict_and_aggregate_threshold({'method': 'threshold'})
2025-03-04 21:56:42,219 - INFO - Threshold: 0.16666666666666666, Selected: 15.55%
2025-03-04 21:56:42,231 - INFO -               precision    recall  f1-score   support

           0       0.87      0.84      0.85      9588
           1       0.13      0.15      0.14      1472

    accuracy                           0.75     11060
   macro avg       0.50      0.50      0.50     11060
weighted avg       0.77      0.75      0.76     11060

2025-03-04 21:56:42,231 - INFO - --------------------------------------------------
2025-03-04 21:56:42,262 - INFO - Classification Report **Per Account** on Validation Set:
predict_and_aggregate_proba({})
2025-03-04 21:56:43,032 - INFO - Threshold: 0.17449040112377087, Selected: 12.01%
2025-03-04 21:56:43,041 - INFO -               precision    recall  f1-score   support

           0       0.87      0.88      0.87      9588
           1       0.13      0.12      0.12      1472

    accuracy                           0.78     11060
   macro avg       0.50      0.50      0.50     11060
weighted avg       0.77      0.78      0.77     11060

2025-03-04 21:56:43,041 - INFO - --------------------------------------------------
2025-03-04 21:56:43,060 - INFO - Classification Report **Per Account** on Validation Set:
predict_and_aggregate_threshold({'method': 'threshold_sum'})
2025-03-04 21:56:43,795 - INFO - Threshold: 36.0, Selected: 15.24%
2025-03-04 21:56:43,805 - INFO -               precision    recall  f1-score   support

           0       0.87      0.85      0.86      9588
           1       0.13      0.15      0.14      1472

    accuracy                           0.75     11060
   macro avg       0.50      0.50      0.50     11060
weighted avg       0.77      0.75      0.76     11060

2025-03-04 21:56:43,805 - INFO - --------------------------------------------------
2025-03-04 21:56:43,832 - INFO - Classification Report **Per Account** on Validation Set:
predict_and_aggregate_threshold({'method': 'mean'})
2025-03-04 21:56:44,576 - INFO -               precision    recall  f1-score   support

           0       0.87      1.00      0.93      9588
           1       0.00      0.00      0.00      1472

    accuracy                           0.87     11060
   macro avg       0.43      0.50      0.46     11060
weighted avg       0.75      0.87      0.80     11060

2025-03-04 21:56:44,576 - INFO - --------------------------------------------------
2025-03-04 21:56:44,669 - INFO - Classification Report **Per Account** on Validation Set with ProbaTrain
2025-03-04 21:56:47,081 - INFO - NaN values in the final result: 0
2025-03-04 21:56:47,082 - INFO - Account features shape: (11059, 16)
2025-03-04 21:56:47,209 - INFO - Account model trained.
2025-03-04 21:56:49,699 - INFO - NaN values in the final result: 0
2025-03-04 21:56:49,701 - INFO - Account features shape: (11060, 16)
2025-03-04 21:56:49,710 - INFO - Threshold: 0.2119472473859787, Selected: 12.01%
2025-03-04 21:56:49,715 - INFO -               precision    recall  f1-score   support

           0       0.87      0.88      0.87      9588
           1       0.14      0.13      0.13      1472

    accuracy                           0.78     11060
   macro avg       0.50      0.50      0.50     11060
weighted avg       0.77      0.78      0.78     11060

2025-03-04 21:56:49,715 - INFO - --------------------------------------------------
2025-03-04 21:56:50,021 - INFO - Loading test data from task/test_set/x_test.ver02.parquet
2025-03-04 21:56:50,603 - INFO - Predicting on test set...
2025-03-04 21:56:52,109 - INFO - Test predictions written to logs/2025.03.04_21:56:32_models.guess_full_retrain_test_transaction.csv
2025-03-04 21:56:53,118 - INFO - Threshold: 0.16666666666666666, Selected: 15.45%
2025-03-04 21:56:53,131 - INFO - Test account id predictions written to logs/2025.03.04_21:56:32_models.guess_full_retrain_test.csv
2025-03-04 21:56:54,573 - INFO - NaN values in the final result: 0
2025-03-04 21:56:54,574 - INFO - Account features shape: (11057, 16)
2025-03-04 21:56:54,585 - INFO - Threshold: 0.21016432344913483, Selected: 12.00%
2025-03-04 21:56:54,592 - INFO - Test account id predictions with ProbaTrain written to logs/2025.03.04_21:56:32_models.guess_full_retrain_test_proba_train.csv
2025-03-04 21:56:54,620 - INFO - Standard evaluation complete.
2025-03-04 21:56:54,620 - INFO - ===============================================
2025-03-04 21:56:54,675 - INFO - Starting full retrain process using model.refit()...
2025-03-04 21:56:54,676 - INFO - Loading training data from multiple sources...
2025-03-04 21:56:54,676 - INFO - Loading data from task/train_set/x_train.ver02.parquet and task/train_set/y_train.ver02.parquet
2025-03-04 21:56:55,818 - INFO - Successfully loaded 1674104 samples from task/train_set/x_train.ver02.parquet with AccountID suffix '_train'
2025-03-04 21:56:55,864 - INFO - Loading data from task/val_set/x_val.ver02.parquet and task/val_set/y_val.ver02.parquet
2025-03-04 21:56:57,486 - INFO - Successfully loaded 1792506 samples from task/val_set/x_val.ver02.parquet with AccountID suffix '_val'
2025-03-04 21:56:57,550 - INFO - Loading data from task/kaggle_set/x_kaggle.ver02.parquet and task/kaggle_set/y_kaggle.ver02.parquet
2025-03-04 21:57:13,949 - INFO - Successfully loaded 6362620 samples from task/kaggle_set/x_kaggle.ver02.parquet with AccountID suffix '_kaggle'
2025-03-04 21:57:14,408 - INFO - Combining all available training data...
2025-03-04 21:57:21,827 - INFO - Combined data: 9829230 samples, 96 features
2025-03-04 21:57:22,148 - INFO - Refitting model...
2025-03-04 21:57:35,330 - INFO - Model refitting completed. Took: 0:00:13.182004
2025-03-04 21:57:35,332 - INFO - Model saved to logs/2025.03.04_21:56:32_models.guess_full_retrain_full_model.pkl
2025-03-04 21:57:35,332 - INFO - Loading test data from task/test_set/x_test.ver02.parquet
2025-03-04 21:57:35,957 - INFO - Predicting on test set...
2025-03-04 21:57:37,051 - INFO - Test predictions written to logs/2025.03.04_21:56:32_models.guess_full_retrain_full_test_transaction.csv
2025-03-04 21:57:37,540 - INFO - Threshold: 0.06896551724137931, Selected: 15.07%
2025-03-04 21:57:37,551 - INFO - Test account id predictions written to logs/2025.03.04_21:56:32_models.guess_full_retrain_full_test.csv
2025-03-04 21:57:37,567 - INFO - Training ProbaTrain on all data for final predictions...
